<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸš Tower Defense</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<!-- Wave Complete Banner -->
<div id="waveBanner" class="wave-banner"></div>

<!-- Achievement Toast -->
<div id="achToast" class="ach-toast"></div>

<!-- Achievement Modal -->
<div id="achModal" class="overlay" style="display:none;">
    <div class="overlay-box ach-box">
        <h2>ğŸ… Errungenschaften</h2>
        <div id="achContent"></div>
        <button id="closeAch" class="btn-primary" style="margin-top:12px;">âœ– SchlieÃŸen</button>
    </div>
</div>

<!-- Tower Shop Tooltip -->
<div id="towerTooltip" class="tower-tooltip" style="display:none;"></div>

<!-- Help Modal -->
<div id="helpModal" class="overlay" style="display:none;">
    <div class="overlay-box help-box">
        <h2>ğŸš Wie spielt man Tower Defense?</h2>
        <div class="help-content">
            <div class="help-section">
                <strong>ğŸ¯ Ziel</strong>
                <p>Verhindere, dass Gegner die ğŸ Ziellinie erreichen. Du hast <strong>20 Leben</strong> â€” jeder durchkommende Gegner kostet dich eins!</p>
            </div>
            <div class="help-section">
                <strong>ğŸ—¼ TÃ¼rme platzieren</strong>
                <p>Klicke einen Turm im Shop, dann klicke auf das Spielfeld. <strong>Nicht auf dem Pfad platzieren!</strong> GrÃ¼ne Markierung = OK, Rot = Blockiert.</p>
                <p>Mit <kbd>Shift</kbd> gedrÃ¼ckt â†’ mehrere TÃ¼rme in Folge platzieren.</p>
            </div>
            <div class="help-section">
                <strong>â¬† Upgrades</strong>
                <p>Klicke einen platzierten Turm â†’ <strong>Info-Panel</strong> zeigt Werte. Upgrade kostet Gold, erhÃ¶ht Schaden & Reichweite.</p>
                <p>Level 2: Ã—1.65 Schaden | Level 3: Ã—2.6 Schaden (Max)</p>
                <p><strong>L3 SpezialfÃ¤higkeiten:</strong><br>
                ğŸ§Š Cryo L3: 15% Freeze-Chance (kurz eingefroren!)<br>
                ğŸ§ª Poison L3: Gift kettet auf nÃ¤chsten Gegner!<br>
                âš¡ Fast L3: Doppelschuss â€” trifft 2 Ziele gleichzeitig!<br>
                ğŸ’¥ Bomber L3: Napalm â€” Splash-Bereich brennt weiter (DoT)!<br>
                ğŸ’£ Heavy L3: Schockwelle â€” Ã¤uÃŸerer Ring 30% Schaden!<br>
                ğŸŒ© Arc L3: +2 SprÃ¼nge (5 Ziele total)!<br>
                ğŸ”­ Sniper L3: Jeder 4. Schuss = KRIT (3Ã— Schaden)!<br>
                ğŸ§² Pulse L3: Jeder 5. Puls = OVERCLOCK (2Ã— Schaden)!</p>
            </div>
            <div class="help-section">
                <strong>ğŸ¯ Ziel-Modi</strong>
                <p>Jeder Turm hat einen Ziel-Modus: <strong>Vorne</strong> (nÃ¤her am Ziel), <strong>Hinten</strong>, <strong>Stark</strong> (meiste HP), <strong>Schwach</strong>.</p>
            </div>
            <div class="help-section">
                <strong>ğŸŒŠ Wellen</strong>
                <p>DrÃ¼cke <strong>â–¶ï¸ Welle starten</strong> oder <kbd>Enter</kbd>. Ab Welle 3 kommen ğŸƒ Fast-Gegner, ab Welle 5 ğŸ›¡ï¸ Tanks, alle 5 Wellen ein ğŸ’€ Boss!</p>
            </div>
            <div class="help-section">
                <strong>ğŸ’° Gold-Tipps</strong>
                <p>Gegner tÃ¶ten â†’ Gold. Welle abschlieÃŸen â†’ Bonus + Zinsen (5% des Goldvorrats). Kein Schaden â†’ +25ğŸ’°.<br>
                <strong>Rechtsklick</strong> auf Turm â†’ sofort verkaufen.</p>
            </div>
            <div class="help-section">
                <strong>ğŸ’€ Boss Drops</strong>
                <p>Wenn ein ğŸ’€ Boss stirbt, fÃ¤llt ein zufÃ¤lliger Drop:<br>
                ğŸ’° Gold-Drop (immer)<br>
                ğŸ’ +1 Leben (25%)<br>
                âš¡ Power Surge: +75% Schaden (12%)</p>
            </div>
            <div class="help-section">
                <strong>âŒ¨ï¸ Shortcuts</strong>
                <p>
                    <kbd>1</kbd>â€“<kbd>9</kbd>, <kbd>0</kbd> Turm wÃ¤hlen<br>
                    <kbd>Space</kbd> Pause &nbsp; <kbd>Enter</kbd> Welle<br>
                    <kbd>Esc</kbd> Aufheben &nbsp; <kbd>Shift</kbd> Mehrfach platzieren<br>
                    <kbd>T</kbd> Ziel-Modus wechseln (bei ausgewÃ¤hltem Turm)<br>
                    <kbd>Ctrl+S</kbd> Speichern &nbsp; <kbd>Ctrl+L</kbd> Laden
                </p>
            </div>
            <div class="help-section">
                <strong>ğŸŒ© Spezial-TÃ¼rme</strong>
                <p>
                    <strong>ğŸ§Š Cryo:</strong> Verlangsamt Gegner fÃ¼r 2.5s.<br>
                    <strong>ğŸ”­ Sniper:</strong> Laser-ZielfÃ¼hrung, hohe Reichweite. Sieht Geister!<br>
                    <strong>ğŸ’¥ Bomber:</strong> Explosion mit FlÃ¤chenschaden. Ignoriert RÃ¼stung!<br>
                    <strong>ğŸŒ© Arc:</strong> Kettenblitz â€” trifft 3 Ziele (65%/42% Schaden).<br>
                    <strong>ğŸ§ª Poison:</strong> Vergiftet Gegner (DoT: 20 Schaden/s fÃ¼r 4s). Hebt Mutanten-Regen auf!<br>
                    <strong>ğŸ§² Pulse:</strong> EM-Puls â€” trifft ALLE Gegner in Reichweite gleichzeitig. Ideal gegen Massen!<br>
                    <strong>ğŸ”¦ Laser:</strong> Kontinuierlicher Dauerstrahl. Schaden steigt von 8â†’42 DPS je lÃ¤nger du dasselbe Ziel triffst (max 2s Lock-on). Ignoriert RÃ¼stung!
                </p>
            </div>
            <div class="help-section">
                <strong>ğŸ‘¾ Sonder-Gegner</strong>
                <p>
                    <strong>ğŸ Schwarm (ab W8):</strong> Teilt sich beim Tod in 3 schnelle Larven ğŸª² auf!<br>
                    <strong>ğŸ§¬ Mutant (ab W10):</strong> Regeneriert 1.5% max HP/s. Poison-TÃ¼rme heben Regen auf!<br>
                    <strong>ğŸ”© Mech (ab W12):</strong> 40% RÃ¼stung â€” nimmt 40% weniger Schaden. Bomber, Pulse, Poison &amp; Laser ignorieren RÃ¼stung!<br>
                    <strong>ğŸ‘» Geist (ab W15):</strong> Unsichtbar â€” kann NUR von Sniper-TÃ¼rmen oder Level-3-TÃ¼rmen angegriffen werden!<br>
                    <strong>ğŸ‘¹ Elite (W7,14,21â€¦):</strong> Besonderer Miniboss mit Bonusdrop beim Besiegen!<br>
                    <strong>Tipp:</strong> Synergieverbundene TÃ¼rme (+10% pro Nachbar) sind besonders stark gegen Mechs.
                </p>
            </div>
        </div>
        <button id="closeHelp" class="btn-primary" style="margin-top:16px;">â–¶ï¸ Spielen!</button>
    </div>
</div>

<!-- Difficulty Select (shown on load) -->
<div id="difficultyOverlay" class="overlay">
    <div class="overlay-box diff-box">
        <div class="diff-title">ğŸš Tower Defense</div>
        <p class="diff-sub">WÃ¤hle deine Schwierigkeitsstufe</p>
        <div class="diff-options">
            <button class="diff-btn diff-easy" data-gold="350" data-lives="30">
                <span class="diff-icon">ğŸŒ±</span>
                <strong>Easy</strong>
                <span>350ğŸ’° Â· 30â¤ï¸</span>
                <span class="diff-note">Entspannte Runde</span>
            </button>
            <button class="diff-btn diff-normal" data-gold="200" data-lives="20">
                <span class="diff-icon">âš”ï¸</span>
                <strong>Normal</strong>
                <span>200ğŸ’° Â· 20â¤ï¸</span>
                <span class="diff-note">Ausgewogen</span>
            </button>
            <button class="diff-btn diff-hard" data-gold="120" data-lives="10">
                <span class="diff-icon">ğŸ’€</span>
                <strong>Hard</strong>
                <span>120ğŸ’° Â· 10â¤ï¸</span>
                <span class="diff-note">FÃ¼r Profis</span>
            </button>
            <button class="diff-btn diff-nightmare" data-gold="80" data-lives="5">
                <span class="diff-icon">â˜ ï¸</span>
                <strong>Nightmare</strong>
                <span>80ğŸ’° Â· 5â¤ï¸</span>
                <span class="diff-note">+20% Gegnergeschwindigkeit</span>
            </button>
        </div>
        <div class="diff-map-label">ğŸ—º Karte wÃ¤hlen:</div>
        <div class="diff-maps" id="diffMaps">
            <button class="map-btn map-active" data-map="0">
                <span>ğŸ</span> <strong>Snake</strong>
                <small>Klassisch</small>
            </button>
            <button class="map-btn" data-map="1">
                <span>âš¡</span> <strong>Zigzag</strong>
                <small>Kehrtwendungen</small>
            </button>
            <button class="map-btn" data-map="2">
                <span>ğŸŒ€</span> <strong>Spiral</strong>
                <small>Langer Weg</small>
            </button>
            <button class="map-btn" data-map="3">
                <span>ğŸ›</span> <strong>Labyrinth</strong>
                <small>EngpÃ¤sse</small>
            </button>
        </div>
        <div class="diff-lb" id="startLb"></div>
    </div>
</div>

<!-- Game Over Overlay -->
<div id="gameOverlay" class="overlay" style="display:none;">
    <div class="overlay-box">
        <div id="overlayTitle" class="overlay-title">ğŸ’€ Game Over!</div>
        <div id="overlayMessage" class="overlay-message"></div>
        <button id="overlayBtn" class="btn-primary overlay-btn">ğŸ”„ Neu starten</button>
    </div>
</div>

<div class="game-container">

    <!-- Header -->
    <div class="header">
        <div class="header-top">
            <h1>ğŸš Shelldon's Tower Defense</h1>
            <div class="header-btns">
                <button id="achBtn" class="help-btn" title="Errungenschaften">ğŸ…</button>
                <button id="helpBtn" class="help-btn" title="Hilfe / How to play">â“</button>
            </div>
        </div>
        <div class="stats-bar">
            <div class="stat gold">
                <span class="stat-icon">ğŸ’°</span>
                <span id="gold">200</span>
            </div>
            <div class="stat lives">
                <span class="stat-icon">â¤ï¸</span>
                <span id="lives">20</span>
            </div>
            <div class="stat wave">
                <span class="stat-icon">ğŸŒŠ</span>
                <span id="wave">0</span>
            </div>
            <div class="stat score">
                <span class="stat-icon">â­</span>
                <span id="score">0</span>
            </div>
            <div class="stat highscore">
                <span class="stat-icon">ğŸ†</span>
                <span id="highscore">0</span>
            </div>
            <div class="stat enemies-stat" id="enemiesStatWrapper" style="display:none;">
                <span class="stat-icon">ğŸ‘¾</span>
                <span id="enemyCount">0</span>
            </div>
            <div class="stat" id="mapStat">
                <span class="stat-icon">ğŸ—º</span>
                <span id="mapName">Snake</span>
            </div>
            <div class="stat" id="timerStat">
                <span class="stat-icon">â±</span>
                <span id="gameTimer">0:00</span>
            </div>
            <div class="stat" id="diffStat">
                <span id="diffIcon">âš”ï¸</span>
            </div>
        </div>
    </div>

    <!-- Main Game Area -->
    <div class="game-area">

        <!-- Canvas -->
        <div class="canvas-wrapper">
            <canvas id="gameCanvas" width="800" height="600"></canvas>
        </div>

        <!-- Side Panel -->
        <div class="side-panel">

            <!-- Tower Shop -->
            <div class="panel-section">
                <h3 class="panel-title">ğŸ—¼ TÃ¼rme kaufen</h3>
                <p class="hint">Shift+Klick = mehrere platzieren</p>
                <div class="tower-grid">
                    <button class="tower-btn" data-type="basic" data-cost="50">
                        <span class="tb-hotkey">1</span>
                        <span class="tb-icon">ğŸ¯</span>
                        <span class="tb-name">Basic</span>
                        <span class="tb-cost">50ğŸ’°</span>
                        <span class="tb-desc">Allrounder</span>
                    </button>
                    <button class="tower-btn" data-type="heavy" data-cost="100">
                        <span class="tb-hotkey">2</span>
                        <span class="tb-icon">ğŸ’£</span>
                        <span class="tb-name">Heavy</span>
                        <span class="tb-cost">100ğŸ’°</span>
                        <span class="tb-desc">Viel Dmg</span>
                    </button>
                    <button class="tower-btn" data-type="fast" data-cost="80">
                        <span class="tb-hotkey">3</span>
                        <span class="tb-icon">âš¡</span>
                        <span class="tb-name">Fast</span>
                        <span class="tb-cost">80ğŸ’°</span>
                        <span class="tb-desc">Rapid fire</span>
                    </button>
                    <button class="tower-btn" data-type="slow" data-cost="75">
                        <span class="tb-hotkey">4</span>
                        <span class="tb-icon">ğŸ§Š</span>
                        <span class="tb-name">Cryo</span>
                        <span class="tb-cost">75ğŸ’°</span>
                        <span class="tb-desc">Slow 60%</span>
                    </button>
                    <button class="tower-btn" data-type="sniper" data-cost="150">
                        <span class="tb-hotkey">5</span>
                        <span class="tb-icon">ğŸ”­</span>
                        <span class="tb-name">Sniper</span>
                        <span class="tb-cost">150ğŸ’°</span>
                        <span class="tb-desc">Long range</span>
                    </button>
                    <button class="tower-btn" data-type="area" data-cost="120">
                        <span class="tb-hotkey">6</span>
                        <span class="tb-icon">ğŸ’¥</span>
                        <span class="tb-name">Bomber</span>
                        <span class="tb-cost">120ğŸ’°</span>
                        <span class="tb-desc">Splash dmg</span>
                    </button>
                    <button class="tower-btn" data-type="arc" data-cost="110">
                        <span class="tb-hotkey">7</span>
                        <span class="tb-icon">ğŸŒ©</span>
                        <span class="tb-name">Arc</span>
                        <span class="tb-cost">110ğŸ’°</span>
                        <span class="tb-desc">Kettenblitz</span>
                    </button>
                    <button class="tower-btn" data-type="poison" data-cost="90">
                        <span class="tb-hotkey">8</span>
                        <span class="tb-icon">ğŸ§ª</span>
                        <span class="tb-name">Poison</span>
                        <span class="tb-cost">90ğŸ’°</span>
                        <span class="tb-desc">Gift DoT</span>
                    </button>
                    <button class="tower-btn" data-type="pulse" data-cost="135">
                        <span class="tb-hotkey">9</span>
                        <span class="tb-icon">ğŸ§²</span>
                        <span class="tb-name">Pulse</span>
                        <span class="tb-cost">135ğŸ’°</span>
                        <span class="tb-desc">EM-Puls</span>
                    </button>
                    <button class="tower-btn tower-btn-wide" data-type="laser" data-cost="165">
                        <span class="tb-hotkey">0</span>
                        <span class="tb-icon">ğŸ”¦</span>
                        <span class="tb-name">Laser</span>
                        <span class="tb-cost">165ğŸ’°</span>
                        <span class="tb-desc">Lock-on Strahl</span>
                    </button>
                </div>
            </div>

            <!-- Selected Tower Info -->
            <div id="towerInfo" class="panel-section tower-info-panel" style="display:none;">
                <h3 class="panel-title">ğŸ” AusgewÃ¤hlt</h3>
                <div id="towerInfoName" class="tower-info-name"></div>
                <div id="towerInfoStats" class="tower-info-stats"></div>
                <div class="target-modes">
                    <span class="tm-label">ğŸ¯ Ziel:</span>
                    <button class="tm-btn active" data-mode="first">Vorne</button>
                    <button class="tm-btn" data-mode="last">Hinten</button>
                    <button class="tm-btn" data-mode="strong">Stark</button>
                    <button class="tm-btn" data-mode="weak">Schwach</button>
                </div>
                <div class="tower-info-actions">
                    <button id="upgradeTower" class="btn-upgrade">â¬† Upgrade</button>
                    <button id="sellTower" class="btn-sell">ğŸ’¸ Sell</button>
                </div>
            </div>

            <!-- Controls -->
            <div class="panel-section">
                <h3 class="panel-title">ğŸ® Steuerung</h3>
                <div class="control-buttons">
                    <button id="startWave" class="btn-primary btn-full">â–¶ï¸ Welle starten</button>
                    <div class="btn-row">
                        <button id="pauseBtn" class="btn-secondary">â¸ Pause</button>
                        <button id="speedBtn" class="btn-secondary">1x â©</button>
                    </div>
                    <div class="btn-row">
                        <button id="soundBtn" class="btn-secondary">ğŸ”Š Sound</button>
                        <label class="toggle-label">
                            <input type="checkbox" id="autoWaveBtn">
                            <span>Auto-Welle</span>
                        </label>
                    </div>
                    <div id="autoWaveStatus" class="auto-wave-status" style="display:none;"></div>
                </div>
            </div>

            <!-- Wave Preview -->
            <div class="panel-section">
                <h3 class="panel-title">ğŸ”­ NÃ¤chste Welle</h3>
                <div id="wavePreview" class="wave-preview">Warte auf Spielstartâ€¦</div>
            </div>

            <!-- Enemy Legend -->
            <div class="panel-section">
                <h3 class="panel-title">ğŸ‘¾ Gegnertypen</h3>
                <div class="enemy-legend">
                    <div class="el-row"><span>ğŸ‘¾</span> <span>Normal (ab W1)</span></div>
                    <div class="el-row"><span>ğŸƒ</span> <span>Fast 2,5Ã— (ab W3)</span></div>
                    <div class="el-row"><span>ğŸ›¡ï¸</span> <span>Tank 3Ã— HP (ab W5)</span></div>
                    <div class="el-row"><span>ğŸ</span> <span>Schwarm â†’ 3 Larven (ab W8)</span></div>
                    <div class="el-row"><span>ğŸ§¬</span> <span>Mutant + Regen (ab W10)</span></div>
                    <div class="el-row"><span>ğŸ”©</span> <span>Mech -40% Dmg (ab W12)</span></div>
                    <div class="el-row"><span>ğŸ‘»</span> <span>Geist unsichtbar (ab W15)</span></div>
                    <div class="el-row"><span>ğŸ‘¹</span> <span>Elite Miniboss (W7,14,21â€¦)</span></div>
                    <div class="el-row"><span>ğŸ’€</span> <span>Boss (W5,10,15â€¦)</span></div>
                </div>
            </div>

            <!-- Keyboard Shortcuts -->
            <div class="panel-section hint-box">
                <strong>âŒ¨ï¸ Shortcuts</strong><br>
                <span>1â€“9, 0</span> Turm &nbsp;
                <span>Space/P</span> Pause<br>
                <span>Enter</span> Welle &nbsp;
                <span>T</span> Ziel-Modus<br>
                <span>Esc</span> Aufheben &nbsp;
                <span>Ctrl+S/L</span> Save/Load
            </div>

        </div>
    </div>

</div>

<script src="game.js"></script>
</body>
</html>
